# Kubernetes资源注入漏洞关键操作分析提示词

请基于提供的漏洞信息，从关键操作维度进行专业分析：

## 关键操作类型分析

**要求**：请从以下关键操作类别中识别该漏洞涉及的操作类型，并分析操作链条：

### 关键操作类别：

#### 1. 命令执行 (Command Execution)
- **直接命令执行**：通过容器args、command字段执行系统命令
- **脚本执行**：执行shell脚本、批处理文件等
- **进程启动**：启动新的系统进程或服务
- **权限切换**：切换用户身份或提升执行权限

#### 2. 文件系统操作 (File System Operations)
- **文件I/O操作**：文件读取、写入、创建、删除等操作
  - 配置文件读写
  - 日志文件操作
  - 临时文件创建
  - 敏感文件访问
- **目录挂载**：挂载宿主机目录或存储卷
  - hostPath挂载
  - 存储卷绑定
  - 设备文件映射
  - 特权目录访问

#### 3. 资源字段解析 (Resource Field Parsing)
- **YAML/JSON解析**：解析Kubernetes资源定义
- **模板渲染**：处理配置模板和变量替换
- **字段验证**：验证资源字段格式和内容
- **数据类型转换**：字段值的类型转换和格式化

#### 4. K8s资源API操作 (Kubernetes Resource API Operations)
- **资源CRUD操作**：创建、读取、更新、删除K8s资源
- **资源查询**：列表查询、字段选择器、标签选择器
- **资源状态更新**：更新资源status字段
- **资源关系处理**：处理ownerReferences、控制器关系等

#### 5. 配置生成 (Configuration Generation)
- **动态配置生成**：基于模板生成配置文件
- **参数注入**：将用户输入注入到配置中
- **环境变量设置**：设置容器环境变量
- **配置合并**：合并多个配置源

#### 6. 格式化输出 (Formatted Output)
- **日志输出格式化**：格式化日志信息输出
- **状态信息显示**：格式化显示资源状态
- **错误信息处理**：格式化错误消息
- **调试信息输出**：输出调试和诊断信息

### 分析要求：
- 按**操作执行顺序**排列涉及的操作类型
- 明确标识**主要操作**和**辅助操作**
- 分析操作间的**依赖关系**和**数据流向**
- 识别**关键风险节点**和**攻击利用点**

### 答题格式：
```
操作链条：[按执行顺序列出操作类型]
主要操作：[操作类型] - [具体操作内容]
辅助操作：[操作类型1, 操作类型2...] - [支撑性操作]
依赖关系：[操作A] → [操作B] → [操作C]
风险节点：[最容易被攻击利用的操作环节]
数据流向：[数据在各操作间的传递路径]
```

## K8s资源注入漏洞Sink点函数统计

**要求**：**仅统计K8s资源注入漏洞的sink点函数**，即最终执行危险操作的函数

### 重要说明：
- **Sink点定义**：污点数据最终流向并执行危险操作的函数
- **严格限制**：只统计sink点函数，不包括source点、中间传播函数或其他辅助函数
- **漏洞特定**：专注于资源注入漏洞的最终危险操作执行点

### 答题格式：
```
K8s资源注入漏洞Sink点函数统计表：
| 关键操作类型 | 关键操作子类型 | Sink点函数个数 | Sink点函数名称 |
|-------------|---------------|---------------|---------------|
| 命令执行 | - | [数量] | [最终执行命令的函数] |
| 文件系统操作 | 文件I/O操作 | [数量] | [最终文件操作的函数] |
| 文件系统操作 | 目录挂载 | [数量] | [最终挂载操作的函数] |
| 资源字段解析 | - | [数量] | [最终解析危险字段的函数] |
| K8s资源API操作 | - | [数量] | [最终执行API操作的函数] |
| 配置生成 | - | [数量] | [最终生成配置的函数] |
| 格式化输出 | - | [数量] | [最终输出的函数] |

Sink点函数代码定位：
- [函数名] (位于 [文件名:行号]) - [Sink点作用描述]
- [函数名] (位于 [文件名:行号]) - [Sink点作用描述]

注：仅统计资源注入漏洞最终执行危险操作的sink点函数
```

## 答题要求

### 格式规范：
- **条目式回答**，使用编号和要点
- **简短句子**，每句不超过30字
- **技术准确**，避免模糊表述
- **总字数控制在300字以内**

### 技术深度：
- 结合**具体的K8s API和组件**分析操作实现
- 引用**关键的代码执行路径**和**数据处理流程**
- **重点关注资源注入漏洞的sink点识别**

### 安全关注：
- 识别**高危操作**和**攻击利用点**
- **专注于sink点函数的危险性分析**

## 示例输出格式

```
1. 关键操作类型分析
   操作链条：K8s资源API操作 → 资源字段解析 → 配置生成 → 命令执行
   主要操作：K8s资源API操作 - 通过PATCH API修改Namespace ownerReferences
   辅助操作：资源字段解析, 配置生成 - 解析修改请求和生成恶意Pod配置
   依赖关系：API PATCH操作 → ownerReferences解析 → 策略验证绕过 → 特权容器部署
   风险节点：资源字段解析阶段缺乏ownerReferences完整性验证
   数据流向：恶意PATCH请求 → API Server → Capsule Webhook → etcd → kubelet

2. K8s资源注入漏洞Sink点函数统计
   K8s资源注入漏洞Sink点函数统计表：
   | 关键操作类型 | 关键操作子类型 | Sink点函数个数 | Sink点函数名称 |
   |-------------|---------------|---------------|---------------|
   | 命令执行 | - | 1 | execCommand() |
   | 文件系统操作 | 文件I/O操作 | 2 | writeFile(), readFile() |
   | 文件系统操作 | 目录挂载 | 1 | mountPath() |
   | 资源字段解析 | - | 1 | applyResourceSpec() |
   | K8s资源API操作 | - | 2 | updateResource(), createPod() |
   | 配置生成 | - | 1 | renderTemplate() |
   | 格式化输出 | - | 0 | - |

   Sink点函数代码定位：
   - execCommand() (位于 runtime/exec.go:89) - 最终执行容器命令
   - mountPath() (位于 volume/mount.go:156) - 最终执行目录挂载
   - createPod() (位于 api/pod.go:234) - 最终创建恶意Pod资源

   注：仅统计资源注入漏洞最终执行危险操作的sink点函数
```

---

**注意**：请严格按照上述格式要求回答，**在函数统计中仅包含K8s资源注入漏洞的sink点函数，即最终执行危险操作的函数，排除所有source点、传播点和辅助函数**。