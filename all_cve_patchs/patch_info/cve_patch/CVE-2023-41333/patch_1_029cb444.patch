From 029cb4447920d3ae134318d7ee9c73e449e9ed41 Mon Sep 17 00:00:00 2001
From: Joe Stringer <joe@cilium.io>
Date: Tue, 5 Sep 2023 14:37:18 -0700
Subject: [PATCH] k8s: Change test for reserved:init to CCNP

Change the expected test for policies that apply to reserved:init pod to
assume that CCNP is used to configure this type of policy.

Signed-off-by: Joe Stringer <joe@cilium.io>
---
 pkg/k8s/apis/cilium.io/utils/utils_test.go | 10 ++--------
 1 file changed, 2 insertions(+), 8 deletions(-)

diff --git a/pkg/k8s/apis/cilium.io/utils/utils_test.go b/pkg/k8s/apis/cilium.io/utils/utils_test.go
index 87ac546bfcbed..900722c256d69 100644
--- a/pkg/k8s/apis/cilium.io/utils/utils_test.go
+++ b/pkg/k8s/apis/cilium.io/utils/utils_test.go
@@ -152,8 +152,7 @@ func Test_ParseToCiliumRule(t *testing.T) {
 			// is for init policies.
 			name: "parse-init-policy",
 			args: args{
-				namespace: slim_metav1.NamespaceDefault,
-				uid:       uuid,
+				uid: uuid,
 				rule: &api.Rule{
 					EndpointSelector: api.NewESFromMatchRequirements(
 						map[string]string{
@@ -178,7 +177,7 @@ func Test_ParseToCiliumRule(t *testing.T) {
 				labels.LabelArray{
 					{
 						Key:    "io.cilium.k8s.policy.derived-from",
-						Value:  "CiliumNetworkPolicy",
+						Value:  "CiliumClusterwideNetworkPolicy",
 						Source: labels.LabelSourceK8s,
 					},
 					{
@@ -186,11 +185,6 @@ func Test_ParseToCiliumRule(t *testing.T) {
 						Value:  "parse-init-policy",
 						Source: labels.LabelSourceK8s,
 					},
-					{
-						Key:    "io.cilium.k8s.policy.namespace",
-						Value:  "default",
-						Source: labels.LabelSourceK8s,
-					},
 					{
 						Key:    "io.cilium.k8s.policy.uid",
 						Value:  string(uuid),
