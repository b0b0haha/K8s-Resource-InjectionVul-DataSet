{
  "cve_id": "CVE-2024-7646",
  "description": "A security issue was discovered in ingress-nginx where an actor with permission to create Ingress objects (in the `networking.k8s.io` or `extensions` API group) can bypass annotation validation to inject arbitrary commands and obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.",
  "references": [
    "https://github.com/kubernetes/ingress-nginx/pull/11719",
    "https://github.com/kubernetes/ingress-nginx/pull/11721",
    "https://github.com/kubernetes/kubernetes/issues/126744",
    "https://groups.google.com/g/kubernetes-security-announce/c/a1__cKjWkfA",
    "http://www.openwall.com/lists/oss-security/2024/08/16/5"
  ],
  "commit_urls": [
    "https://github.com/kubernetes/ingress-nginx/commit/9a6cf10a64111db38d7280266650a237e0318028",
    "https://github.com/kubernetes/ingress-nginx/commit/2003f8563cf0c093dad83d0cbe83cb2daf29e80b"
  ],
  "pr_urls": [
    "https://github.com/kubernetes/ingress-nginx/pull/11719",
    "https://github.com/kubernetes/ingress-nginx/pull/11721"
  ],
  "issue_urls": [
    "https://github.com/kubernetes/kubernetes/issues/126744"
  ],
  "advisory_urls": [],
  "related_commits": [
    {
      "type": "pr_commit",
      "hash": "9a6cf10a64111db38d7280266650a237e0318028",
      "url": "https://github.com/kubernetes/ingress-nginx/commit/9a6cf10a64111db38d7280266650a237e0318028",
      "pr_url": "https://github.com/kubernetes/ingress-nginx/pull/11719",
      "pr_number": "11719",
      "owner": "kubernetes",
      "repo": "ingress-nginx",
      "message": "Missing anchors in regular expression.",
      "author": "André Storfjord Kristiansen",
      "date": "2024-08-01T15:18:49Z"
    },
    {
      "type": "pr_commit",
      "hash": "2003f8563cf0c093dad83d0cbe83cb2daf29e80b",
      "url": "https://github.com/kubernetes/ingress-nginx/commit/2003f8563cf0c093dad83d0cbe83cb2daf29e80b",
      "pr_url": "https://github.com/kubernetes/ingress-nginx/pull/11721",
      "pr_number": "11721",
      "owner": "kubernetes",
      "repo": "ingress-nginx",
      "message": "Perform some cleaning operations on line breaks.\n\nCo-authored-by: Jintao Zhang <zhangjintao9020@gmail.com>",
      "author": "André Storfjord Kristiansen",
      "date": "2024-08-01T15:14:26Z"
    }
  ],
  "commits": [
    "https://github.com/kubernetes/ingress-nginx/commit/9a6cf10a64111db38d7280266650a237e0318028",
    "https://github.com/kubernetes/ingress-nginx/commit/2003f8563cf0c093dad83d0cbe83cb2daf29e80b",
    {
      "type": "pr_commit",
      "hash": "9a6cf10a64111db38d7280266650a237e0318028",
      "url": "https://github.com/kubernetes/ingress-nginx/commit/9a6cf10a64111db38d7280266650a237e0318028",
      "pr_url": "https://github.com/kubernetes/ingress-nginx/pull/11719",
      "pr_number": "11719",
      "owner": "kubernetes",
      "repo": "ingress-nginx",
      "message": "Missing anchors in regular expression.",
      "author": "André Storfjord Kristiansen",
      "date": "2024-08-01T15:18:49Z"
    },
    {
      "type": "pr_commit",
      "hash": "2003f8563cf0c093dad83d0cbe83cb2daf29e80b",
      "url": "https://github.com/kubernetes/ingress-nginx/commit/2003f8563cf0c093dad83d0cbe83cb2daf29e80b",
      "pr_url": "https://github.com/kubernetes/ingress-nginx/pull/11721",
      "pr_number": "11721",
      "owner": "kubernetes",
      "repo": "ingress-nginx",
      "message": "Perform some cleaning operations on line breaks.\n\nCo-authored-by: Jintao Zhang <zhangjintao9020@gmail.com>",
      "author": "André Storfjord Kristiansen",
      "date": "2024-08-01T15:14:26Z"
    }
  ]
}