From 9a6cf10a64111db38d7280266650a237e0318028 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andr=C3=A9=20Storfjord=20Kristiansen?=
 <33384479+dev-bio@users.noreply.github.com>
Date: Thu, 1 Aug 2024 17:18:49 +0200
Subject: [PATCH] Missing anchors in regular expression.

---
 internal/ingress/annotations/authtls/main.go | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/internal/ingress/annotations/authtls/main.go b/internal/ingress/annotations/authtls/main.go
index b331a215e9..1c6bad4857 100644
--- a/internal/ingress/annotations/authtls/main.go
+++ b/internal/ingress/annotations/authtls/main.go
@@ -41,7 +41,7 @@ const (
 )
 
 var (
-	authVerifyClientRegex = regexp.MustCompile(`on|off|optional|optional_no_ca`)
+	authVerifyClientRegex = regexp.MustCompile(`^(on|off|optional|optional_no_ca)$`)
 	redirectRegex         = regexp.MustCompile(`^((https?://)?[A-Za-z0-9\-.]*(:\d+)?/[A-Za-z0-9\-.]*)?$`)
 )
 
