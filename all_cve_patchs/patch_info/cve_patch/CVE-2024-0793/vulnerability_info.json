{
  "cve_id": "CVE-2024-0793",
  "description": "A flaw was found in kube-controller-manager. This issue occurs when the initial application of a HPA config YAML lacking a .spec.behavior.scaleUp block causes a denial of service due to KCM pods going into restart churn.",
  "references": [
    "https://access.redhat.com/errata/RHSA-2024:0741",
    "https://access.redhat.com/errata/RHSA-2024:1267",
    "https://access.redhat.com/security/cve/CVE-2024-0793",
    "https://bugzilla.redhat.com/show_bug.cgi?id=2214402",
    "https://github.com/openshift/kubernetes/pull/1876"
  ],
  "commit_urls": [],
  "pr_urls": [
    "https://github.com/openshift/kubernetes/pull/1876"
  ],
  "issue_urls": [],
  "advisory_urls": [],
  "related_commits": [
    {
      "type": "pr_commit",
      "hash": "0e0f66f848e7a50630a64340bc0d1ff33c10087a",
      "url": "https://github.com/openshift/kubernetes/commit/0e0f66f848e7a50630a64340bc0d1ff33c10087a",
      "pr_url": "https://github.com/openshift/kubernetes/pull/1876",
      "pr_number": "1876",
      "owner": "openshift",
      "repo": "kubernetes",
      "message": "UPSTREAM: 114358: Default missing fields in HPA behaviors\n\nThe description in the autoscaling API for the HorizontalPodAutoscaler\nsuggests that HorizontalPodAutoscalerSpec's Behavior field (and its\nScaleUp and ScaleDown members) are optional. And that if not supplied,\ndefaults will be used.\n\nThat's true if the entire Behavior is nil because, we go\nthrough \"normalizeDesiredReplicas\" instead of\n\"normalizeDesiredReplicasWithBehaviors\", but if the structure is only\npartially supplied, leaving some members nil, it results in nil\ndereferences when we end up going though\nnormalizeDesiredReplicasWithBehaviors.\n\nSo we end up in a situation where:\n- If Behavior is entirely absent (nil) we use defaults (good)\n- If Behavior is partially specified we panic (very bad)\n- If stabilizationWindowSeconds is nil in either ScaleUp or Scaledown,\n  we panic (also very bad)\n\nIn general, this only happens with pre-v2 HPA objects because v2 does\nproperly fill in the default values.\n\nThis commit prevents the panic by using the defaulters to ensure that\nunpopulated fields in the behavior objects get filled in with their\ndefaults before they are used, so they can safely be dereferenced by\nlater code that performs calculations on them.",
      "author": "John Kyros",
      "date": "2024-01-31T21:54:59Z"
    }
  ],
  "commits": [
    {
      "type": "pr_commit",
      "hash": "0e0f66f848e7a50630a64340bc0d1ff33c10087a",
      "url": "https://github.com/openshift/kubernetes/commit/0e0f66f848e7a50630a64340bc0d1ff33c10087a",
      "pr_url": "https://github.com/openshift/kubernetes/pull/1876",
      "pr_number": "1876",
      "owner": "openshift",
      "repo": "kubernetes",
      "message": "UPSTREAM: 114358: Default missing fields in HPA behaviors\n\nThe description in the autoscaling API for the HorizontalPodAutoscaler\nsuggests that HorizontalPodAutoscalerSpec's Behavior field (and its\nScaleUp and ScaleDown members) are optional. And that if not supplied,\ndefaults will be used.\n\nThat's true if the entire Behavior is nil because, we go\nthrough \"normalizeDesiredReplicas\" instead of\n\"normalizeDesiredReplicasWithBehaviors\", but if the structure is only\npartially supplied, leaving some members nil, it results in nil\ndereferences when we end up going though\nnormalizeDesiredReplicasWithBehaviors.\n\nSo we end up in a situation where:\n- If Behavior is entirely absent (nil) we use defaults (good)\n- If Behavior is partially specified we panic (very bad)\n- If stabilizationWindowSeconds is nil in either ScaleUp or Scaledown,\n  we panic (also very bad)\n\nIn general, this only happens with pre-v2 HPA objects because v2 does\nproperly fill in the default values.\n\nThis commit prevents the panic by using the defaulters to ensure that\nunpopulated fields in the behavior objects get filled in with their\ndefaults before they are used, so they can safely be dereferenced by\nlater code that performs calculations on them.",
      "author": "John Kyros",
      "date": "2024-01-31T21:54:59Z"
    }
  ]
}