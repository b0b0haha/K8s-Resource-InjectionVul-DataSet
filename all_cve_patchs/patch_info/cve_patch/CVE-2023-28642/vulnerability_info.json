{
  "cve_id": "CVE-2023-28642",
  "description": "runc is a CLI tool for spawning and running containers according to the OCI specification. It was found that AppArmor can be bypassed when `/proc` inside the container is symlinked with a specific mount configuration. This issue has been fixed in runc version 1.1.5, by prohibiting symlinked `/proc`. See PR #3785 for details. users are advised to upgrade. Users unable to upgrade should avoid using an untrusted container image.\n\n",
  "references": [
    "https://github.com/opencontainers/runc/pull/3785",
    "https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c",
    "https://security.netapp.com/advisory/ntap-20241206-0005/"
  ],
  "commit_urls": [],
  "pr_urls": [
    "https://github.com/opencontainers/runc/pull/3785"
  ],
  "issue_urls": [],
  "advisory_urls": [
    "https://github.com/opencontainers/runc/security/advisories/GHSA-g2j6-57v7-gm8c"
  ],
  "related_commits": [
    {
      "type": "pr_commit",
      "hash": "0abab45c9b97c113ff2cdc16f3a7388444c3fbec",
      "url": "https://github.com/opencontainers/runc/commit/0abab45c9b97c113ff2cdc16f3a7388444c3fbec",
      "pr_url": "https://github.com/opencontainers/runc/pull/3785",
      "pr_number": "3785",
      "owner": "opencontainers",
      "repo": "runc",
      "message": "Prohibit /proc and /sys to be symlinks\n\nCommit 3291d66b9844 introduced a check for /proc and /sys, making sure\nthe destination (dest) is a directory (and not e.g. a symlink).\n\nLater, a hunk from commit 0ca91f44f switched from using filepath.Join\nto SecureJoin for dest. As SecureJoin follows and resolves symlinks,\nthe check whether dest is a symlink no longer works.\n\nTo fix, do the check without/before using SecureJoin.\n\nAdd integration tests to make sure we won't regress.\n\nSigned-off-by: Kir Kolyshkin <kolyshkin@gmail.com>\n(cherry picked from commit 0d72adf96dda1b687815bf89bb245b937a2f603c)\nSigned-off-by: Sebastiaan van Stijn <github@gone.nl>",
      "author": "Kir Kolyshkin",
      "date": "2023-03-16T21:35:50Z"
    }
  ],
  "commits": [
    {
      "type": "pr_commit",
      "hash": "0abab45c9b97c113ff2cdc16f3a7388444c3fbec",
      "url": "https://github.com/opencontainers/runc/commit/0abab45c9b97c113ff2cdc16f3a7388444c3fbec",
      "pr_url": "https://github.com/opencontainers/runc/pull/3785",
      "pr_number": "3785",
      "owner": "opencontainers",
      "repo": "runc",
      "message": "Prohibit /proc and /sys to be symlinks\n\nCommit 3291d66b9844 introduced a check for /proc and /sys, making sure\nthe destination (dest) is a directory (and not e.g. a symlink).\n\nLater, a hunk from commit 0ca91f44f switched from using filepath.Join\nto SecureJoin for dest. As SecureJoin follows and resolves symlinks,\nthe check whether dest is a symlink no longer works.\n\nTo fix, do the check without/before using SecureJoin.\n\nAdd integration tests to make sure we won't regress.\n\nSigned-off-by: Kir Kolyshkin <kolyshkin@gmail.com>\n(cherry picked from commit 0d72adf96dda1b687815bf89bb245b937a2f603c)\nSigned-off-by: Sebastiaan van Stijn <github@gone.nl>",
      "author": "Kir Kolyshkin",
      "date": "2023-03-16T21:35:50Z"
    }
  ]
}