{
  "index": 3,
  "original_url": "https://github.com/proglottis/gpgme/commit/d43d199046c30db9bef90de20c09843bb8b45737",
  "patch_url": "https://github.com/proglottis/gpgme/commit/d43d199046c30db9bef90de20c09843bb8b45737.patch",
  "commit_info": {
    "type": "pr_commit",
    "hash": "d43d199046c30db9bef90de20c09843bb8b45737",
    "url": "https://github.com/proglottis/gpgme/commit/d43d199046c30db9bef90de20c09843bb8b45737",
    "pr_url": "https://github.com/proglottis/gpgme/pull/23",
    "pr_number": "23",
    "owner": "proglottis",
    "repo": "gpgme",
    "message": "Ensure Data is not dellocated while C code is still using it\n\nAs far as Go is concerned, Data.dh and Data.cbc are just values, so it is\nOK to implement\n> cgo_call(d.dh)\nas\n> tmp := d.dh\n> dropReferenceTo(d)\n> // d's finalizer can be called at any point from now on, possibly deallocating d.dh\n> cgo_call(tmp) // possibly using free memory\n\nTo fix this, explicitly extend the lifetime of Data:\n> cgo_call(d.dh)\n> runtime.KeepAlive(d)\nbecomes\n> tmp := d.dh\n> cgo_call(tmp) // d.dh is certainly still valid\n> dropReferenceTo(d)\n> // d's finalizer can be called from now on, possibly deallocating d.dh\n\nSigned-off-by: Miloslav Trmač <mitr@redhat.com>",
    "author": "Miloslav Trmač",
    "date": "2020-01-10T15:40:46Z"
  },
  "patch_stats": {
    "files_modified": 2,
    "lines_added": 34,
    "lines_removed": 7,
    "total_changes": 41,
    "file_list": [
      "data.go",
      "gpgme.go"
    ],
    "file_extensions": [
      "go"
    ],
    "binary_files": 0
  }
}