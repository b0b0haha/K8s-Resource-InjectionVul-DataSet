From 79dd86581c2a5e42bd4dbaa39b70c2be58d1e6f9 Mon Sep 17 00:00:00 2001
From: Stefan Prodan <stefan.prodan@gmail.com>
Date: Sat, 11 Sep 2021 18:56:41 +0300
Subject: [PATCH] Remove kubectl dependency

Signed-off-by: Stefan Prodan <stefan.prodan@gmail.com>
---
 Dockerfile | 14 --------------
 1 file changed, 14 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index 5603b74a..6bd20ea3 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,19 +1,7 @@
 FROM golang:1.16-alpine as builder
 
-ARG TARGETPLATFORM
-
 WORKDIR /workspace
 
-RUN apk add --no-cache ca-certificates curl
-
-RUN kubectl_ver=1.21.3 && \
-arch=${TARGETPLATFORM:-linux/amd64} && \
-if [ "$TARGETPLATFORM" == "linux/arm/v7" ]; then arch="linux/arm"; fi && \
-curl -sL https://storage.googleapis.com/kubernetes-release/release/v${kubectl_ver}/bin/${arch}/kubectl \
--o /usr/local/bin/kubectl && chmod +x /usr/local/bin/kubectl
-
-RUN kubectl version --client=true
-
 # copy api submodule
 COPY api/ api/
 
@@ -38,7 +26,6 @@ LABEL org.opencontainers.image.source="https://github.com/fluxcd/kustomize-contr
 
 RUN apk add --no-cache ca-certificates tini git openssh-client gnupg
 
-COPY --from=builder /usr/local/bin/kubectl /usr/local/bin/
 COPY --from=builder /workspace/kustomize-controller /usr/local/bin/
 
 # Create minimal nsswitch.conf file to prioritize the usage of /etc/hosts over DNS queries.
@@ -50,6 +37,5 @@ RUN addgroup -S controller && adduser -S controller -G controller
 USER controller
 
 ENV GNUPGHOME=/tmp
-COPY config/kubeconfig /home/controller/.kube/config
 
 ENTRYPOINT [ "/sbin/tini", "--", "kustomize-controller" ]
