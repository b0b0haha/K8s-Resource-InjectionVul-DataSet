{
  "cve_id": "CVE-2024-12401",
  "description": "A flaw was found in the cert-manager package. This flaw allows an attacker who can modify PEM data that the cert-manager reads, for example, in a Secret resource, to use large amounts of CPU in the cert-manager controller pod to effectively create a denial-of-service (DoS) vector for the cert-manager in the cluster.",
  "references": [
    "https://access.redhat.com/security/cve/CVE-2024-12401",
    "https://bugzilla.redhat.com/show_bug.cgi?id=2327929",
    "https://github.com/cert-manager/cert-manager/pull/7400",
    "https://github.com/cert-manager/cert-manager/pull/7401",
    "https://github.com/cert-manager/cert-manager/pull/7402",
    "https://github.com/cert-manager/cert-manager/pull/7403",
    "https://github.com/cert-manager/cert-manager/security/advisories/GHSA-r4pg-vg54-wxx4",
    "https://go.dev/issue/50116"
  ],
  "commit_urls": [],
  "pr_urls": [
    "https://github.com/cert-manager/cert-manager/pull/7400",
    "https://github.com/cert-manager/cert-manager/pull/7401",
    "https://github.com/cert-manager/cert-manager/pull/7402",
    "https://github.com/cert-manager/cert-manager/pull/7403"
  ],
  "issue_urls": [],
  "advisory_urls": [
    "https://github.com/cert-manager/cert-manager/security/advisories/GHSA-r4pg-vg54-wxx4"
  ],
  "related_commits": [
    {
      "type": "pr_commit",
      "hash": "3a4c9eb55e2e43570679840bbe3217869fbc8efc",
      "url": "https://github.com/cert-manager/cert-manager/commit/3a4c9eb55e2e43570679840bbe3217869fbc8efc",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7400",
      "pr_number": "7400",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "f22f78c8c0a64d718e203b326bc844c488ad7850",
      "url": "https://github.com/cert-manager/cert-manager/commit/f22f78c8c0a64d718e203b326bc844c488ad7850",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7400",
      "pr_number": "7400",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T17:42:28Z"
    },
    {
      "type": "pr_commit",
      "hash": "481b67be51ce4907cc565d2acb1e998b2c0ea667",
      "url": "https://github.com/cert-manager/cert-manager/commit/481b67be51ce4907cc565d2acb1e998b2c0ea667",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
      "pr_number": "7401",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "d99dddbadf9fc058bb1d22a03f692d4ea759196a",
      "url": "https://github.com/cert-manager/cert-manager/commit/d99dddbadf9fc058bb1d22a03f692d4ea759196a",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
      "pr_number": "7401",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T17:42:28Z"
    },
    {
      "type": "pr_commit",
      "hash": "3ba1f2cafc4c16c1aa18a482027bc91e359f731f",
      "url": "https://github.com/cert-manager/cert-manager/commit/3ba1f2cafc4c16c1aa18a482027bc91e359f731f",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
      "pr_number": "7401",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "[release-1.16] bump base images\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-06T14:00:07Z"
    },
    {
      "type": "pr_commit",
      "hash": "7fc813f3c5950ccf6df6ce290f5923d3176d12f1",
      "url": "https://github.com/cert-manager/cert-manager/commit/7fc813f3c5950ccf6df6ce290f5923d3176d12f1",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7402",
      "pr_number": "7402",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "0792f092aaa57825b92420c7dd821062f4c7f6af",
      "url": "https://github.com/cert-manager/cert-manager/commit/0792f092aaa57825b92420c7dd821062f4c7f6af",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7402",
      "pr_number": "7402",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T17:42:28Z"
    },
    {
      "type": "pr_commit",
      "hash": "52cb2e70e27faacbeeeac73e1c116bb7724c78ec",
      "url": "https://github.com/cert-manager/cert-manager/commit/52cb2e70e27faacbeeeac73e1c116bb7724c78ec",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7403",
      "pr_number": "7403",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "a197d8f2f18001898b46e038ba3eb0ad8cf1420f",
      "url": "https://github.com/cert-manager/cert-manager/commit/a197d8f2f18001898b46e038ba3eb0ad8cf1420f",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7403",
      "pr_number": "7403",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "[release-1.12] security: remove calls to pem.Decode in non-test code\n\nThe changes are much smaller scoped in release-1.12 due to bigger diffs with master\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-05T15:35:33Z"
    }
  ],
  "commits": [
    {
      "type": "pr_commit",
      "hash": "3a4c9eb55e2e43570679840bbe3217869fbc8efc",
      "url": "https://github.com/cert-manager/cert-manager/commit/3a4c9eb55e2e43570679840bbe3217869fbc8efc",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7400",
      "pr_number": "7400",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "f22f78c8c0a64d718e203b326bc844c488ad7850",
      "url": "https://github.com/cert-manager/cert-manager/commit/f22f78c8c0a64d718e203b326bc844c488ad7850",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7400",
      "pr_number": "7400",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T17:42:28Z"
    },
    {
      "type": "pr_commit",
      "hash": "481b67be51ce4907cc565d2acb1e998b2c0ea667",
      "url": "https://github.com/cert-manager/cert-manager/commit/481b67be51ce4907cc565d2acb1e998b2c0ea667",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
      "pr_number": "7401",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "d99dddbadf9fc058bb1d22a03f692d4ea759196a",
      "url": "https://github.com/cert-manager/cert-manager/commit/d99dddbadf9fc058bb1d22a03f692d4ea759196a",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
      "pr_number": "7401",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T17:42:28Z"
    },
    {
      "type": "pr_commit",
      "hash": "3ba1f2cafc4c16c1aa18a482027bc91e359f731f",
      "url": "https://github.com/cert-manager/cert-manager/commit/3ba1f2cafc4c16c1aa18a482027bc91e359f731f",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
      "pr_number": "7401",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "[release-1.16] bump base images\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-06T14:00:07Z"
    },
    {
      "type": "pr_commit",
      "hash": "7fc813f3c5950ccf6df6ce290f5923d3176d12f1",
      "url": "https://github.com/cert-manager/cert-manager/commit/7fc813f3c5950ccf6df6ce290f5923d3176d12f1",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7402",
      "pr_number": "7402",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "0792f092aaa57825b92420c7dd821062f4c7f6af",
      "url": "https://github.com/cert-manager/cert-manager/commit/0792f092aaa57825b92420c7dd821062f4c7f6af",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7402",
      "pr_number": "7402",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T17:42:28Z"
    },
    {
      "type": "pr_commit",
      "hash": "52cb2e70e27faacbeeeac73e1c116bb7724c78ec",
      "url": "https://github.com/cert-manager/cert-manager/commit/52cb2e70e27faacbeeeac73e1c116bb7724c78ec",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7403",
      "pr_number": "7403",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-01T14:46:10Z"
    },
    {
      "type": "pr_commit",
      "hash": "a197d8f2f18001898b46e038ba3eb0ad8cf1420f",
      "url": "https://github.com/cert-manager/cert-manager/commit/a197d8f2f18001898b46e038ba3eb0ad8cf1420f",
      "pr_url": "https://github.com/cert-manager/cert-manager/pull/7403",
      "pr_number": "7403",
      "owner": "cert-manager",
      "repo": "cert-manager",
      "message": "[release-1.12] security: remove calls to pem.Decode in non-test code\n\nThe changes are much smaller scoped in release-1.12 due to bigger diffs with master\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
      "author": "Ashley Davis",
      "date": "2024-11-05T15:35:33Z"
    }
  ]
}