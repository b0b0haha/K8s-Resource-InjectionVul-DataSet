{
  "cve_id": "CVE-2024-12401",
  "total_patches": 9,
  "total_files_modified": 61,
  "total_lines_added": 1642,
  "total_lines_removed": 227,
  "total_changes": 1869,
  "file_extensions": [
    "mk",
    "go",
    "bin"
  ],
  "binary_files": 0,
  "patch_details": [
    {
      "patch_index": 1,
      "commit_hash": "3a4c9eb5",
      "patch_file": "patch_1_3a4c9eb5.patch",
      "patch_stats": {
        "files_modified": 5,
        "lines_added": 312,
        "lines_removed": 1,
        "total_changes": 313,
        "file_list": [
          "internal/pem/decode.go",
          "internal/pem/decode_test.go",
          "internal/pem/testdata/issue-ghsa-r4pg-vg54-wxx4.bin",
          "pkg/util/pki/generate_keysize_test.go",
          "pkg/util/pki/parse.go"
        ],
        "file_extensions": [
          "go",
          "bin"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "3a4c9eb55e2e43570679840bbe3217869fbc8efc",
        "url": "https://github.com/cert-manager/cert-manager/commit/3a4c9eb55e2e43570679840bbe3217869fbc8efc",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7400",
        "pr_number": "7400",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T14:46:10Z"
      }
    },
    {
      "patch_index": 2,
      "commit_hash": "f22f78c8",
      "patch_file": "patch_2_f22f78c8.patch",
      "patch_stats": {
        "files_modified": 12,
        "lines_added": 113,
        "lines_removed": 62,
        "total_changes": 175,
        "file_list": [
          "internal/controller/certificates/policies/checks_test.go",
          "internal/controller/certificates/secrets.go",
          "pkg/controller/acmeorders/sync.go",
          "pkg/controller/acmeorders/sync_test.go",
          "pkg/controller/certificates/issuing/internal/secret_test.go",
          "pkg/controller/certificates/issuing/secret_manager_test.go",
          "pkg/util/pki/generate_test.go",
          "pkg/util/pki/nameconstraints_test.go",
          "pkg/util/pki/parse.go",
          "pkg/util/pki/parse_certificate_chain.go",
          "pkg/util/pki/parse_certificate_chain_test.go",
          "pkg/util/pki/sans_test.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "f22f78c8c0a64d718e203b326bc844c488ad7850",
        "url": "https://github.com/cert-manager/cert-manager/commit/f22f78c8c0a64d718e203b326bc844c488ad7850",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7400",
        "pr_number": "7400",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T17:42:28Z"
      }
    },
    {
      "patch_index": 3,
      "commit_hash": "481b67be",
      "patch_file": "patch_3_481b67be.patch",
      "patch_stats": {
        "files_modified": 5,
        "lines_added": 312,
        "lines_removed": 1,
        "total_changes": 313,
        "file_list": [
          "internal/pem/decode.go",
          "internal/pem/decode_test.go",
          "internal/pem/testdata/issue-ghsa-r4pg-vg54-wxx4.bin",
          "pkg/util/pki/generate_keysize_test.go",
          "pkg/util/pki/parse.go"
        ],
        "file_extensions": [
          "go",
          "bin"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "481b67be51ce4907cc565d2acb1e998b2c0ea667",
        "url": "https://github.com/cert-manager/cert-manager/commit/481b67be51ce4907cc565d2acb1e998b2c0ea667",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
        "pr_number": "7401",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T14:46:10Z"
      }
    },
    {
      "patch_index": 4,
      "commit_hash": "d99dddba",
      "patch_file": "patch_4_d99dddba.patch",
      "patch_stats": {
        "files_modified": 12,
        "lines_added": 113,
        "lines_removed": 62,
        "total_changes": 175,
        "file_list": [
          "internal/controller/certificates/policies/checks_test.go",
          "internal/controller/certificates/secrets.go",
          "pkg/controller/acmeorders/sync.go",
          "pkg/controller/acmeorders/sync_test.go",
          "pkg/controller/certificates/issuing/internal/secret_test.go",
          "pkg/controller/certificates/issuing/secret_manager_test.go",
          "pkg/util/pki/generate_test.go",
          "pkg/util/pki/nameconstraints_test.go",
          "pkg/util/pki/parse.go",
          "pkg/util/pki/parse_certificate_chain.go",
          "pkg/util/pki/parse_certificate_chain_test.go",
          "pkg/util/pki/sans_test.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "d99dddbadf9fc058bb1d22a03f692d4ea759196a",
        "url": "https://github.com/cert-manager/cert-manager/commit/d99dddbadf9fc058bb1d22a03f692d4ea759196a",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
        "pr_number": "7401",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T17:42:28Z"
      }
    },
    {
      "patch_index": 5,
      "commit_hash": "3ba1f2ca",
      "patch_file": "patch_5_3ba1f2ca.patch",
      "patch_stats": {
        "files_modified": 1,
        "lines_added": 10,
        "lines_removed": 10,
        "total_changes": 20,
        "file_list": [
          "make/base_images.mk"
        ],
        "file_extensions": [
          "mk"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "3ba1f2cafc4c16c1aa18a482027bc91e359f731f",
        "url": "https://github.com/cert-manager/cert-manager/commit/3ba1f2cafc4c16c1aa18a482027bc91e359f731f",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7401",
        "pr_number": "7401",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "[release-1.16] bump base images\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-06T14:00:07Z"
      }
    },
    {
      "patch_index": 6,
      "commit_hash": "7fc813f3",
      "patch_file": "patch_6_7fc813f3.patch",
      "patch_stats": {
        "files_modified": 5,
        "lines_added": 312,
        "lines_removed": 1,
        "total_changes": 313,
        "file_list": [
          "internal/pem/decode.go",
          "internal/pem/decode_test.go",
          "internal/pem/testdata/issue-ghsa-r4pg-vg54-wxx4.bin",
          "pkg/util/pki/generate_keysize_test.go",
          "pkg/util/pki/parse.go"
        ],
        "file_extensions": [
          "go",
          "bin"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "7fc813f3c5950ccf6df6ce290f5923d3176d12f1",
        "url": "https://github.com/cert-manager/cert-manager/commit/7fc813f3c5950ccf6df6ce290f5923d3176d12f1",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7402",
        "pr_number": "7402",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T14:46:10Z"
      }
    },
    {
      "patch_index": 7,
      "commit_hash": "0792f092",
      "patch_file": "patch_7_0792f092.patch",
      "patch_stats": {
        "files_modified": 12,
        "lines_added": 113,
        "lines_removed": 62,
        "total_changes": 175,
        "file_list": [
          "internal/controller/certificates/policies/checks_test.go",
          "internal/controller/certificates/secrets.go",
          "pkg/controller/acmeorders/sync.go",
          "pkg/controller/acmeorders/sync_test.go",
          "pkg/controller/certificates/issuing/internal/secret_test.go",
          "pkg/controller/certificates/issuing/secret_manager_test.go",
          "pkg/util/pki/generate_test.go",
          "pkg/util/pki/nameconstraints_test.go",
          "pkg/util/pki/parse.go",
          "pkg/util/pki/parse_certificate_chain.go",
          "pkg/util/pki/parse_certificate_chain_test.go",
          "pkg/util/pki/sans_test.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "0792f092aaa57825b92420c7dd821062f4c7f6af",
        "url": "https://github.com/cert-manager/cert-manager/commit/0792f092aaa57825b92420c7dd821062f4c7f6af",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7402",
        "pr_number": "7402",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: remove calls to pem.Decode in non-test code\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T17:42:28Z"
      }
    },
    {
      "patch_index": 8,
      "commit_hash": "52cb2e70",
      "patch_file": "patch_8_52cb2e70.patch",
      "patch_stats": {
        "files_modified": 5,
        "lines_added": 312,
        "lines_removed": 1,
        "total_changes": 313,
        "file_list": [
          "internal/pem/decode.go",
          "internal/pem/decode_test.go",
          "internal/pem/testdata/issue-ghsa-r4pg-vg54-wxx4.bin",
          "pkg/util/pki/generate_keysize_test.go",
          "pkg/util/pki/parse.go"
        ],
        "file_extensions": [
          "go",
          "bin"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "52cb2e70e27faacbeeeac73e1c116bb7724c78ec",
        "url": "https://github.com/cert-manager/cert-manager/commit/52cb2e70e27faacbeeeac73e1c116bb7724c78ec",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7403",
        "pr_number": "7403",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "security: Add functions to limit max PEM sizes allowable\n\nIncludes a lot of comments explaining how the maxima were calculated.\nThis is _very_ conservative, and assumes we're dealing with RSA keys\ntwice the size of what we actually allow as a maximum.\n\nFrom running the included benchmark it seems the pathological runtime is\nabout 13617196ns (13ms) on an M2 Max which seems acceptable.\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-01T14:46:10Z"
      }
    },
    {
      "patch_index": 9,
      "commit_hash": "a197d8f2",
      "patch_file": "patch_9_a197d8f2.patch",
      "patch_stats": {
        "files_modified": 4,
        "lines_added": 45,
        "lines_removed": 27,
        "total_changes": 72,
        "file_list": [
          "internal/controller/certificates/secrets.go",
          "pkg/controller/acmeorders/sync.go",
          "pkg/util/pki/csr.go",
          "pkg/util/pki/parse.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "pr_commit",
        "hash": "a197d8f2f18001898b46e038ba3eb0ad8cf1420f",
        "url": "https://github.com/cert-manager/cert-manager/commit/a197d8f2f18001898b46e038ba3eb0ad8cf1420f",
        "pr_url": "https://github.com/cert-manager/cert-manager/pull/7403",
        "pr_number": "7403",
        "owner": "cert-manager",
        "repo": "cert-manager",
        "message": "[release-1.12] security: remove calls to pem.Decode in non-test code\n\nThe changes are much smaller scoped in release-1.12 due to bigger diffs with master\n\nSigned-off-by: Ashley Davis <ashley.davis@venafi.com>",
        "author": "Ashley Davis",
        "date": "2024-11-05T15:35:33Z"
      }
    }
  ],
  "repositories": [
    "cert-manager/cert-manager"
  ],
  "commit_authors": [
    "Ashley Davis"
  ],
  "commit_dates": [
    "2024-11-01T14:46:10Z",
    "2024-11-01T17:42:28Z",
    "2024-11-01T14:46:10Z",
    "2024-11-01T17:42:28Z",
    "2024-11-06T14:00:07Z",
    "2024-11-01T14:46:10Z",
    "2024-11-01T17:42:28Z",
    "2024-11-01T14:46:10Z",
    "2024-11-05T15:35:33Z"
  ]
}