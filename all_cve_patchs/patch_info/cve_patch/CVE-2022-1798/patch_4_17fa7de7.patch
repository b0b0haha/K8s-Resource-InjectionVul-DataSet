From 17fa7de73f4e7809aaa9f2313aee6660925eaf03 Mon Sep 17 00:00:00 2001
From: Roman Mohr <rmohr@google.com>
Date: Thu, 21 Jul 2022 12:47:12 +0200
Subject: [PATCH] The name of the builtin package is not populated

Signed-off-by: Roman Mohr <rmohr@google.com>
---
 tools/analyzers/banncheck/banncheck/banned_api.go | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/tools/analyzers/banncheck/banncheck/banned_api.go b/tools/analyzers/banncheck/banncheck/banned_api.go
index cd6b8af7c48f..44219971f552 100644
--- a/tools/analyzers/banncheck/banncheck/banned_api.go
+++ b/tools/analyzers/banncheck/banncheck/banned_api.go
@@ -84,7 +84,13 @@ func checkBannedFunctions(pass *analysis.Pass, bannedFns map[string][]config.Ban
 			continue
 		}
 
-		fnName := fmt.Sprintf("%s.%s", fn.Pkg().Path(), fn.Name())
+		// "builtin" package is nil
+		pkgName := "builtin"
+		if fn.Pkg() != nil {
+			pkgName = fn.Pkg().Name()
+		}
+
+		fnName := fmt.Sprintf("%s.%s", pkgName, fn.Name())
 		err := reportIfBanned(fnName, bannedFns, id.Pos(), pass)
 		if err != nil {
 			return false, err
