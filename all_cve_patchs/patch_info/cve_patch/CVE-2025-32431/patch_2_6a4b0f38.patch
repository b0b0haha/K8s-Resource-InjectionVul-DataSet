From 6a4b0f387a30f6f92bb3b40bd9d000cd3e6550ed Mon Sep 17 00:00:00 2001
From: Romain <rtribotte@users.noreply.github.com>
Date: Mon, 14 Apr 2025 11:28:53 +0200
Subject: [PATCH] Apply suggestions from code review

Co-authored-by: Kevin Pollet <pollet.kevin@gmail.com>
---
 pkg/server/server_entrypoint_tcp.go      | 2 +-
 pkg/server/server_entrypoint_tcp_test.go | 1 -
 2 files changed, 1 insertion(+), 2 deletions(-)

diff --git a/pkg/server/server_entrypoint_tcp.go b/pkg/server/server_entrypoint_tcp.go
index 0d4dbd8a06..d8807574b2 100644
--- a/pkg/server/server_entrypoint_tcp.go
+++ b/pkg/server/server_entrypoint_tcp.go
@@ -720,7 +720,7 @@ func denyFragment(h http.Handler) http.Handler {
 }
 
 // cleanPath is a http.Handler that cleans the URL path.
-// It cleans the request URL path and rawPath, and updates the request URI.
+// It cleans the request URL Path and RawPath, and updates the request URI.
 func cleanPath(h http.Handler) http.Handler {
 	return http.HandlerFunc(func(rw http.ResponseWriter, req *http.Request) {
 		r2 := new(http.Request)
diff --git a/pkg/server/server_entrypoint_tcp_test.go b/pkg/server/server_entrypoint_tcp_test.go
index cfbb388ae7..6f52cc7dcd 100644
--- a/pkg/server/server_entrypoint_tcp_test.go
+++ b/pkg/server/server_entrypoint_tcp_test.go
@@ -395,7 +395,6 @@ func TestCleanPath(t *testing.T) {
 		{"/a/../../../c/../b", "/b"},
 		{"/a/../c/../../b", "/b"},
 		{"/a/..//c/.././b", "/b"},
-		{"/abc/def/../../../ghi/jkl/../../../mno", "/mno"},
 	}
 
 	for _, test := range tests {
