{
  "cve_id": "CVE-2021-43784",
  "total_patches": 6,
  "total_files_modified": 24,
  "total_lines_added": 936,
  "total_lines_removed": 54,
  "total_changes": 990,
  "file_extensions": [
    "go",
    "c"
  ],
  "binary_files": 0,
  "patch_details": [
    {
      "patch_index": 1,
      "commit_hash": "9c444070",
      "patch_file": "patch_1_9c444070.patch",
      "patch_stats": {
        "files_modified": 8,
        "lines_added": 412,
        "lines_removed": 25,
        "total_changes": 437,
        "file_list": [
          "libcontainer/configs/mount.go",
          "libcontainer/container_linux.go",
          "libcontainer/factory_linux.go",
          "libcontainer/init_linux.go",
          "libcontainer/message_linux.go",
          "libcontainer/nsenter/nsexec.c",
          "libcontainer/rootfs_linux.go",
          "libcontainer/standard_init_linux.go"
        ],
        "file_extensions": [
          "go",
          "c"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "url": "https://github.com/opencontainers/runc/commit/9c444070ec7bb83995dbc0185da68284da71c554"
      }
    },
    {
      "patch_index": 2,
      "commit_hash": "d72d057b",
      "patch_file": "patch_2_d72d057b.patch",
      "patch_stats": {
        "files_modified": 2,
        "lines_added": 28,
        "lines_removed": 1,
        "total_changes": 29,
        "file_list": [
          "libcontainer/container_linux.go",
          "libcontainer/message_linux.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "url": "https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae"
      }
    },
    {
      "patch_index": 3,
      "commit_hash": "f50369af",
      "patch_file": "patch_3_f50369af.patch",
      "patch_stats": {
        "files_modified": 2,
        "lines_added": 28,
        "lines_removed": 1,
        "total_changes": 29,
        "file_list": [
          "libcontainer/container_linux.go",
          "libcontainer/message_linux.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "url": "https://github.com/opencontainers/runc/commit/f50369af4b571e358f20b139eea52d612eb55eed"
      }
    },
    {
      "patch_index": 4,
      "commit_hash": "9c444070",
      "patch_file": "patch_4_9c444070.patch",
      "patch_stats": {
        "files_modified": 8,
        "lines_added": 412,
        "lines_removed": 25,
        "total_changes": 437,
        "file_list": [
          "libcontainer/configs/mount.go",
          "libcontainer/container_linux.go",
          "libcontainer/factory_linux.go",
          "libcontainer/init_linux.go",
          "libcontainer/message_linux.go",
          "libcontainer/nsenter/nsexec.c",
          "libcontainer/rootfs_linux.go",
          "libcontainer/standard_init_linux.go"
        ],
        "file_extensions": [
          "go",
          "c"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "direct_commit",
        "hash": "9c444070ec7bb83995dbc0185da68284da71c554",
        "url": "https://github.com/opencontainers/runc/commit/9c444070ec7bb83995dbc0185da68284da71c554",
        "owner": "opencontainers",
        "repo": "runc",
        "message": "Open bind mount sources from the host userns\n\nThe source of the bind mount might not be accessible in a different user\nnamespace because a component of the source path might not be traversed\nunder the users and groups mapped inside the user namespace. This caused\nerrors such as the following:\n\n  # time=\"2020-06-22T13:48:26Z\" level=error msg=\"container_linux.go:367:\n  starting container process caused: process_linux.go:459:\n  container init caused: rootfs_linux.go:58:\n  mounting \\\"/tmp/busyboxtest/source-inaccessible/dir\\\"\n  to rootfs at \\\"/tmp/inaccessible\\\" caused:\n  stat /tmp/busyboxtest/source-inaccessible/dir: permission denied\"\n\nTo solve this problem, this patch performs the following:\n\n1. in nsexec.c, it opens the source path in the host userns (so we have\n   the right permissions to open it) but in the container mntns (so the\n   kernel cross mntns mount check let us mount it later:\n   https://github.com/torvalds/linux/blob/v5.8/fs/namespace.c#L2312).\n\n2. in nsexec.c, it passes the file descriptors of the source to the\n   child process with SCM_RIGHTS.\n\n3. In runc-init in Golang, it finishes the mounts while inside the\n   userns even without access to the some components of the source\n   paths.\n\nPassing the fds with SCM_RIGHTS is necessary because once the child\nprocess is in the container mntns, it is already in the container userns\nso it cannot temporarily join the host mntns.\n\nThis patch uses the existing mechanism with _LIBCONTAINER_* environment\nvariables to pass the file descriptors from runc to runc init.\n\nThis patch uses the existing mechanism with the Netlink-style bootstrap\nto pass information about the list of source mounts to nsexec.c.\n\nRootless containers don't use this bind mount sources fdpassing\nmechanism because we can't setns() to the target mntns in a rootless\ncontainer (we don't have the privileges when we are in the host userns).\n\nThis patch takes care of using O_CLOEXEC on mount fds, and close them\nearly.\n\nFixes: #2484.\n\nSigned-off-by: Alban Crequy <alban@kinvolk.io>\nSigned-off-by: Rodrigo Campos <rodrigo@kinvolk.io>\nCo-authored-by: Rodrigo Campos <rodrigo@kinvolk.io>",
        "author": "Alban Crequy",
        "date": "2020-09-03T12:41:05Z"
      }
    },
    {
      "patch_index": 5,
      "commit_hash": "d72d057b",
      "patch_file": "patch_5_d72d057b.patch",
      "patch_stats": {
        "files_modified": 2,
        "lines_added": 28,
        "lines_removed": 1,
        "total_changes": 29,
        "file_list": [
          "libcontainer/container_linux.go",
          "libcontainer/message_linux.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "direct_commit",
        "hash": "d72d057ba794164c3cce9451a00b72a78b25e1ae",
        "url": "https://github.com/opencontainers/runc/commit/d72d057ba794164c3cce9451a00b72a78b25e1ae",
        "owner": "opencontainers",
        "repo": "runc",
        "message": "runc init: avoid netlink message length overflows\n\nWhen writing netlink messages, it is possible to have a byte array\nlarger than UINT16_MAX which would result in the length field\noverflowing and allowing user-controlled data to be parsed as control\ncharacters (such as creating custom mount points, changing which set of\nnamespaces to allow, and so on).\n\nCo-authored-by: Kir Kolyshkin <kolyshkin@gmail.com>\nSigned-off-by: Kir Kolyshkin <kolyshkin@gmail.com>\nSigned-off-by: Aleksa Sarai <cyphar@cyphar.com>",
        "author": "Aleksa Sarai",
        "date": "2021-11-18T05:12:59Z"
      }
    },
    {
      "patch_index": 6,
      "commit_hash": "f50369af",
      "patch_file": "patch_6_f50369af.patch",
      "patch_stats": {
        "files_modified": 2,
        "lines_added": 28,
        "lines_removed": 1,
        "total_changes": 29,
        "file_list": [
          "libcontainer/container_linux.go",
          "libcontainer/message_linux.go"
        ],
        "file_extensions": [
          "go"
        ],
        "binary_files": 0
      },
      "commit_info": {
        "type": "direct_commit",
        "hash": "f50369af4b571e358f20b139eea52d612eb55eed",
        "url": "https://github.com/opencontainers/runc/commit/f50369af4b571e358f20b139eea52d612eb55eed",
        "owner": "opencontainers",
        "repo": "runc",
        "message": "Merge pull request from GHSA-v95c-p5hm-xq8f\n\nrunc init: avoid netlink message length overflows",
        "author": "Aleksa Sarai",
        "date": "2021-12-06T04:30:29Z"
      }
    }
  ],
  "repositories": [
    "opencontainers/runc"
  ],
  "commit_authors": [
    "Aleksa Sarai",
    "Alban Crequy"
  ],
  "commit_dates": [
    "2020-09-03T12:41:05Z",
    "2021-11-18T05:12:59Z",
    "2021-12-06T04:30:29Z"
  ]
}